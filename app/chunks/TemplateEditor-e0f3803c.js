import{S as J,i as K,s as M,e as k,t as U,k as q,c as y,a as z,h as x,m as H,d as w,b as I,g as L,F as E,j as Q,Y as R,w as W,x as $,Z as ee,X as B,_ as G,y as te,H as X,q as ae,o as ne,P as le,B as se,L as oe,G as T,$ as ie,N as re}from"./vendor-ead71bd5.js";import{t as Y,d as Z,f as N,a as P,c as ce,b as de}from"./store-d6a74387.js";import{g as j}from"./navigation-bd39ff07.js";function A(t,e,a){const l=t.slice();return l[17]=e[a],l}function F(t){let e,a=t[17].name+"",l,r,f;return{c(){e=k("option"),l=U(a),r=q(),this.h()},l(c){e=y(c,"OPTION",{class:!0});var i=z(e);l=x(i,a),r=H(i),i.forEach(w),this.h()},h(){e.__value=f=t[17],e.value=e.__value,I(e,"class","svelte-1tpxmzo")},m(c,i){L(c,e,i),E(e,l),E(e,r)},p(c,i){i&8&&a!==(a=c[17].name+"")&&Q(l,a),i&8&&f!==(f=c[17])&&(e.__value=f,e.value=e.__value)},d(c){c&&w(e)}}}function ue(t){let e,a,l,r,f,c,i,m,C,v,h=t[3],s=[];for(let o=0;o<h.length;o+=1)s[o]=F(A(t,h,o));let S={html:t[1]};return i=new R({props:S}),t[10](i),i.$on("change",t[11]),{c(){e=k("div"),a=k("div"),l=k("select"),r=k("option"),f=U("select a template ");for(let o=0;o<s.length;o+=1)s[o].c();c=q(),W(i.$$.fragment),this.h()},l(o){e=y(o,"DIV",{class:!0});var _=z(e);a=y(_,"DIV",{class:!0});var p=z(a);l=y(p,"SELECT",{name:!0,id:!0,class:!0});var d=z(l);r=y(d,"OPTION",{class:!0});var b=z(r);f=x(b,"select a template "),b.forEach(w);for(let O=0;O<s.length;O+=1)s[O].l(d);d.forEach(w),p.forEach(w),c=H(_),$(i.$$.fragment,_),_.forEach(w),this.h()},h(){r.__value="select a template",r.value=r.__value,r.selected=!0,r.disabled=!0,I(r,"class","svelte-1tpxmzo"),I(l,"name","template-select"),I(l,"id","template-select"),I(l,"class","svelte-1tpxmzo"),t[2]===void 0&&ee(()=>t[8].call(l)),I(a,"class","editor-header svelte-1tpxmzo"),I(e,"class","template-editor-root svelte-1tpxmzo"),B(e,"placeholder",!t[1])},m(o,_){L(o,e,_),E(e,a),E(a,l),E(l,r),E(r,f);for(let p=0;p<s.length;p+=1)s[p].m(l,null);G(l,t[2]),E(e,c),te(i,e,null),m=!0,C||(v=[X(l,"change",t[8]),X(l,"change",t[9])],C=!0)},p(o,[_]){if(_&8){h=o[3];let d;for(d=0;d<h.length;d+=1){const b=A(o,h,d);s[d]?s[d].p(b,_):(s[d]=F(b),s[d].c(),s[d].m(l,null))}for(;d<s.length;d+=1)s[d].d(1);s.length=h.length}_&12&&G(l,o[2]);const p={};_&2&&(p.html=o[1]),i.$set(p),_&2&&B(e,"placeholder",!o[1])},i(o){m||(ae(i.$$.fragment,o),m=!0)},o(o){ne(i.$$.fragment,o),m=!1},d(o){o&&w(e),le(s,o),t[10](null),se(i),C=!1,oe(v)}}}function _e(t,e,a){let l,r,f,c,i,m;T(t,Y,n=>a(6,l=n)),T(t,Z,n=>a(7,r=n)),T(t,N,n=>a(12,f=n)),T(t,P,n=>a(3,c=n)),T(t,ce,n=>a(13,i=n)),T(t,de,n=>a(14,m=n));let{action:C}=e,{currentData:v}=e,h,s=C==="edit"&&(v==null?void 0:v.mailContent)?v.mailContent:"",S;function o(){const n=new Date;if(m.tab==="email-follow-ups"){const u=f.find(g=>g.id===m.id);(u&&!u.date||u.date.valueOf()<n.valueOf())&&N.update(g=>{const V=g.findIndex(D=>D.id===m.id);return V!==-1&&(g[V].date=n),g}),u.mailContent=s}else c.find(g=>g.id===m.id)&&P.update(g=>{const V=g.findIndex(D=>D.id===m.id);return V!==-1&&(g[V].mailContent=s),g})}function _(){if(i==="template-create"){const n=c.findIndex(u=>u.id===c.length-1);P.update(u=>(u[n].mailContent=s,u))}else{const n=f.findIndex(u=>u.id===f.length-1);N.update(u=>(u[n].mailContent=s,u))}}function p(){S=ie(this),a(2,S)}const d=()=>{s&&a(1,s+="<br />"),a(1,s+=S.mailContent),h.setHtml(s)};function b(n){re[n?"unshift":"push"](()=>{h=n,a(0,h)})}const O=n=>{a(1,s=n.detail)};return t.$$set=n=>{"action"in n&&a(4,C=n.action),"currentData"in n&&a(5,v=n.currentData)},t.$$.update=()=>{t.$$.dirty&128&&r&&(_(),Z.set(!1),j("/")),t.$$.dirty&64&&l&&(o(),Y.set(!1),j("/"))},[h,s,S,c,C,v,l,r,p,d,b,O]}class pe extends J{constructor(e){super();K(this,e,_e,ue,M,{action:4,currentData:5})}}export{pe as T};
